import csv
usefulList = ["roeAvg", "npMargin", "netProfit", "epsTTM", "MBRevenue",
              "totalShare", "liqaShare", "AssetTurnRatio", "YOYEquity", "YOYNI", "YOYEPSBasic", "YOYPNI", "YOYLiability",
              "liabilityToAsset", "assetToEquity", "CFOToOR", "CFOToNP", "CFOToGr", "dupontROE", "dupontAssetStoEquity",
              "dupontAssetTurn", "dupontPnitoni", "dupontNitogr", "dupontTaxBurden"]
stockCode = ["SH.600000",
             "SH.600004",
             "SH.600009",
             "SH.600010",
             "SH.600011",
             "SH.600015",
             "SH.600016",
             "SH.600018",
             "SH.600019",
             "SH.600025",
             "SH.600027",
             "SH.600028",
             "SH.600029",
             "SH.600030",
             "SH.600031",
             "SH.600036",
             "SH.600038",
             "SH.600048",
             "SH.600050",
             "SH.600061",
             "SH.600066",
             "SH.600068",
             "SH.600085",
             "SH.600089",
             "SH.600104",
             "SH.600109",
             "SH.600111",
             "SH.600115",
             "SH.600118",
             "SH.600170",
             "SH.600176",
             "SH.600177",
             "SH.600183",
             "SH.600188",
             "SH.600196",
             "SH.600208",
             "SH.600219",
             "SH.600221",
             "SH.600233",
             "SH.600271",
             "SH.600276",
             "SH.600297",
             "SH.600299",
             "SH.600309",
             "SH.600332",
             "SH.600340",
             "SH.600346",
             "SH.600352",
             "SH.600362",
             "SH.600369",
             "SH.600372",
             "SH.600383",
             "SH.600390",
             "SH.600398",
             "SH.600406",
             "SH.600436",
             "SH.600438",
             "SH.600482",
             "SH.600487",
             "SH.600489",
             "SH.600498",
             "SH.600516",
             "SH.600519",
             "SH.600522",
             "SH.600547",
             "SH.600570",
             "SH.600583",
             "SH.600585",
             "SH.600588",
             "SH.600606",
             "SH.600637",
             "SH.600655",
             "SH.600660",
             "SH.600674",
             "SH.600690",
             "SH.600703",
             "SH.600705",
             "SH.600741",
             "SH.600745",
             "SH.600760",
             "SH.600795",
             "SH.600809",
             "SH.600837",
             "SH.600848",
             "SH.600867",
             "SH.600886",
             "SH.600887",
             "SH.600893",
             "SH.600900",
             "SH.600919",
             "SH.600926",
             "SH.600928",
             "SH.600958",
             "SH.600968",
             "SH.600977",
             "SH.600989",
             "SH.600998",
             "SH.600999",
             "SH.601006",
             "SH.601009",
             "SH.601012",
             "SH.601018",
             "SH.601021",
             "SH.601066",
             "SH.601077",
             "SH.601088",
             "SH.601100",
             "SH.601108",
             "SH.601111",
             "SH.601117",
             "SH.601138",
             "SH.601155",
             "SH.601162",
             "SH.601166",
             "SH.601169",
             "SH.601186",
             "SH.601198",
             "SH.601211",
             "SH.601212",
             "SH.601216",
             "SH.601225",
             "SH.601229",
             "SH.601231",
             "SH.601236",
             "SH.601238",
             "SH.601288",
             "SH.601298",
             "SH.601318",
             "SH.601319",
             "SH.601328",
             "SH.601336",
             "SH.601360",
             "SH.601377",
             "SH.601390",
             "SH.601398",
             "SH.601555",
             "SH.601577",
             "SH.601600",
             "SH.601601",
             "SH.601607",
             "SH.601618",
             "SH.601628",
             "SH.601633",
             "SH.601658",
             "SH.601668",
             "SH.601669",
             "SH.601688",
             "SH.601698",
             "SH.601727",
             "SH.601766",
             "SH.601788",
             "SH.601800",
             "SH.601808",
             "SH.601816",
             "SH.601818",
             "SH.601828",
             "SH.601838",
             "SH.601857",
             "SH.601877",
             "SH.601878",
             "SH.601881",
             "SH.601888",
             "SH.601898",
             "SH.601899",
             "SH.601901",
             "SH.601916",
             "SH.601919",
             "SH.601933",
             "SH.601939",
             "SH.601985",
             "SH.601988",
             "SH.601989",
             "SH.601992",
             "SH.601997",
             "SH.601998",
             "SH.603019",
             "SH.603156",
             "SH.603160",
             "SH.603259",
             "SH.603260",
             "SH.603288",
             "SH.603369",
             "SH.603501",
             "SH.603658",
             "SH.603799",
             "SH.603833",
             "SH.603899",
             "SH.603986",
             "SH.603993",
             "SZ.000001",
             "SZ.000002",
             "SZ.000063",
             "SZ.000066",
             "SZ.000069",
             "SZ.000100",
             "SZ.000157",
             "SZ.000166",
             "SZ.000333",
             "SZ.000338",
             "SZ.000425",
             "SZ.000538",
             "SZ.000568",
             "SZ.000596",
             "SZ.000625",
             "SZ.000627",
             "SZ.000651",
             "SZ.000656",
             "SZ.000661",
             "SZ.000671",
             "SZ.000703",
             "SZ.000708",
             "SZ.000709",
             "SZ.000723",
             "SZ.000725",
             "SZ.000728",
             "SZ.000768",
             "SZ.000776",
             "SZ.000783",
             "SZ.000786",
             "SZ.000858",
             "SZ.000860",
             "SZ.000876",
             "SZ.000895",
             "SZ.000938",
             "SZ.000961",
             "SZ.000963",
             "SZ.000977",
             "SZ.001979",
             "SZ.002001",
             "SZ.002007",
             "SZ.002008",
             "SZ.002024",
             "SZ.002027",
             "SZ.002032",
             "SZ.002044",
             "SZ.002050",
             "SZ.002120",
             "SZ.002129",
             "SZ.002142",
             "SZ.002146",
             "SZ.002153",
             "SZ.002157",
             "SZ.002179",
             "SZ.002202",
             "SZ.002230",
             "SZ.002236",
             "SZ.002241",
             "SZ.002252",
             "SZ.002271",
             "SZ.002304",
             "SZ.002311",
             "SZ.002352",
             "SZ.002371",
             "SZ.002410",
             "SZ.002415",
             "SZ.002422",
             "SZ.002456",
             "SZ.002460",
             "SZ.002463",
             "SZ.002466",
             "SZ.002468",
             "SZ.002475",
             "SZ.002493",
             "SZ.002508",
             "SZ.002555",
             "SZ.002558",
             "SZ.002594",
             "SZ.002601",
             "SZ.002602",
             "SZ.002607",
             "SZ.002624",
             "SZ.002673",
             "SZ.002714",
             "SZ.002736",
             "SZ.002739",
             "SZ.002773",
             "SZ.002841",
             "SZ.002916",
             "SZ.002938",
             "SZ.002939",
             "SZ.002945",
             "SZ.002958",
             "SZ.003816",
             "SZ.300003",
             "SZ.300014",
             "SZ.300015",
             "SZ.300033",
             "SZ.300059",
             "SZ.300122",
             "SZ.300124",
             "SZ.300136",
             "SZ.300142",
             "SZ.300144",
             "SZ.300347",
             "SZ.300408",
             "SZ.300413",
             "SZ.300433",
             "SZ.300498",
             "SZ.300601",
             "SZ.300628",
             "SZ.300017",
             "SH.600733",
             "SH.600663",
             "SH.600566",
             "SH.600535",
             "SH.600153",
             "SH.600100",
             "SH.600023",
             "SZ.300070",
             "SZ.300024",
             "SH.600816",
             "SZ.002411",
             "SZ.000629",
             "SZ.002294",
             "SZ.000413",
             "SZ.000423",
             "SZ.000415",
             "SZ.000630",
             "SZ.000898",
             "SZ.002010",
             "SZ.002081",
             "SH.603858",
             "SH.601228",
             "SH.600704",
             "SH.600688",
             "SH.600415",
             "SH.600339",
             "SZ.300296",
             "SZ.300251",
             "SZ.300072",
             "SZ.002625",
             "SZ.002310",
             "SZ.002065",
             "SZ.000553",
             "SZ.000408",
             "SZ.000402",
             "SZ.002925",
             "SZ.002572",
             "SH.601991",
             "SH.601611",
             "SH.601333",
             "SH.600909",
             "SH.600739",
             "SH.600549",
             "SH.600518",
             "SZ.002797",
             "SH.600157",
             "SZ.002450",
             "SZ.002085",
             "SZ.001965",
             "SZ.000983",
             "SZ.000959",
             "SZ.000839",
             "SZ.000826",
             "SZ.000792",
             "SZ.000503",
             "SH.600820",
             "SH.600376",
             "SH.600663",
             "SH.600682",
             "SH.600804",
             "SH.600008",
             "SH.600959",
             "SH.601099",
             "SH.601718",
             "SH.601866",
             "SH.601958",
             "SH.600373",
             "SZ.000559",
             "SZ.300027",
             "SZ.002074",
             "SZ.002739",
             "SZ.000540",
             "SZ.000060",
             "SZ.000723",
             "SZ.000623",
             "SZ.002385",
             "SZ.002470",
             "SZ.002500",
             "SZ.002608",
             "SH.600895",
             "SH.600485",
             "SH.600649",
             "SH.600685",
             "SH.600827",
             "SH.600871",
             "SH.600021",
             "SH.601118",
             "SH.601163",
             "SH.601375",
             "SH.601608",
             "SH.601872",
             "SH.600074",
             "SH.601966",
             "SZ.300315",
             "SZ.002292",
             "SZ.002841",
             "SZ.000686",
             "SZ.000738",
             "SZ.000750",
             "SZ.002174",
             "SZ.000008",
             "SZ.002424",
             "SZ.002465",
             "SZ.002831",
             "SZ.002839",
             "SZ.002426",
             "SZ.300168",
             "SH.600037",
             "SZ.002299",
             "SZ.300133",
             "SH.600150",
             "SH.600060",
             "SH.601127",
             "SH.600256",
             "SH.600446",
             "SH.600718",
             "SH.600737",
             "SZ.300104",
             "SZ.000156",
             "SZ.002195",
             "SZ.000917",
             "SZ.002183",
             "SZ.000009",
             "SZ.000718",
             "SZ.000793",
             "SZ.000555",
             "SZ.000977",
             "SZ.002049",
             "SZ.002131",
             "SZ.002152",
             "SH.600867",
             "SH.600654",
             "SH.600666",
             "SH.600754",
             "SH.600783",
             "SH.600839",
             "SH.601258",
             "SH.600873",
             "SH.600875",
             "SH.601928",
             "SH.603000",
             "SH.603885",
             "SH.600582",
             "SH.600648",
             "SH.600252",
             "SZ.000027",
             "SZ.002129",
             "SZ.300182",
             "SZ.000039",
             "SZ.000061",
             "SZ.000712",
             "SZ.000800",
             "SZ.002085",
             "SZ.000778",
             "SZ.002568",
             "SZ.300002",
             "SZ.300015",
             "SZ.300058",
             "SZ.300085",
             "SZ.300146",
             "SH.601106",
             "SH.600600",
             "SH.600642",
             "SH.600863",
             "SH.600998",
             "SH.601016",
             "SH.601098",
             "SH.601808",
             "SH.601117",
             "SH.601179",
             "SH.601898",
             "SH.601991",
             "SH.601992",
             "SH.600398",
             "SH.600578",
             "SH.600098",
             "SH.600317",
             "SZ.002294",
             "SZ.000046",
             "SZ.000729",
             "SZ.000883",
             "SZ.000898",
             "SZ.000999",
             "SZ.000825",
             "SZ.002399",
             "SH.600022",
             "SZ.002422",
             "SH.600027",
             "SH.600011",
             "SZ.300003",
             "SH.600166",
             "SH.603288",
             "SH.601969",
             "SH.601699",
             "SH.601231",
             "SH.601158",
             "SH.600717",
             "SH.600633",
             "SH.600350",
             "SH.600315",
             "SH.601238",
             "SZ.002410",
             "SZ.000629",
             "SZ.002375",
             "SZ.000400",
             "SZ.000581",
             "SZ.000598",
             "SZ.000539",
             "SZ.000831",
             "SZ.000937",
             "SZ.000983",
             "SZ.002038",
             "SZ.002353",
             "SH.600108",
             "SH.601168",
             "SH.600809",
             "SH.600597",
             "SH.600516",
             "SH.600497",
             "SH.600348",
             "SH.600316",
             "SH.601929",
             "SH.600277",
             "SZ.002653",
             "SZ.000970",
             "SZ.002570",
             "SZ.000839",
             "SZ.000960",
             "SZ.000878",
             "SZ.002001",
             "SZ.002051",
             "SZ.002310",
             "SZ.002344",
             "SH.603699",
             "SH.600058",
             "SH.600880",
             "SZ.000401",
             "SZ.000536",
             "SZ.000869",
             "SZ.002416",
             "SZ.002429",
             "SZ.002603",
             "SZ.002400",
             "SH.600079",
             "SH.600267",
             "SH.600395",
             "SH.600436",
             "SH.600498",
             "SH.600655",
             "SH.600143",
             "SH.600664",
             "SH.600546",
             "SH.601991",
             "SH.600123",
             "SH.601918",
             "SZ.000012",
             "SZ.000656",
             "SZ.000718",
             "SZ.000758",
             "SZ.002106",
             "SZ.002269",
             "SH.600062",
             "SH.600096",
             "SZ.000961",
             "SH.600216",
             "SH.600259",
             "SH.600376",
             "SH.600403",
             "SH.600895",
             "SH.601139",
             "SH.601238",
             "SH.601666",
             "SH.600219",
             "SH.601717",
             "SH.600528",
             "SH.601369",
             "SZ.000528",
             "SZ.000596",
             "SZ.000933",
             "SZ.002069",
             "SZ.002155",
             "SZ.002299",
             "SZ.000046",
             "SZ.002431",
             "SH.600160",
             "SH.600266",
             "SZ.000703",
             "SH.600582",
             "SH.600997",
             "SH.600598",
             "SH.601106",
             "SH.601101",
             "SH.601001",
             "SH.601099",
             "SH.600971",
             "SH.600970",
             "SH.600859",
             "SH.600811",
             "SH.600694",
             "SH.600508",
             "SH.601788",
             "SZ.002092",
             "SZ.000027",
             "SH.600881",
             "SZ.000422",
             "SZ.000539",
             "SZ.000780",
             "SZ.000807",
             "SZ.000883",
             "SZ.000969",
             "SZ.000059",
             "SZ.002128",
             "SH.600005",
             "SH.600125",
             "SH.600132",
             "SH.600169",
             "SH.600432",
             "SH.600550",
             "SH.600779",
             "SZ.002378",
             "SZ.000968",
             "SH.601558",
             "SH.600022",
             "SH.601233",
             "SZ.000898",
             "SZ.000559",
             "SZ.002073",
             "SZ.002122",
             "SZ.002405",
             "SZ.000825",
             "SH.600037",
             "SH.600456",
             "SH.600770",
             "SH.601179",
             "SH.601216",
             "SH.600331",
             "SH.601991",
             "SH.600500",
             "SZ.000680",
             "SZ.002493",
             "SH.600183",
             "SH.600320",
             "SH.600418",
             "SH.600307",
             "SH.600595",
             "SH.600812",
             "SH.601268",
             "SH.601566",
             "SH.601718",
             "SH.601919",
             "SZ.000021",
             "SH.600161",
             "SH.601727",
             "SH.600380",
             "SH.601519",
             "SZ.000027",
             "SZ.002244",
             "SH.600008",
             "SH.600026",
             "SH.600098",
             "SH.600151",
             "SZ.002498",
             "SH.600428",
             "SH.600582",
             "SH.600635",
             "SH.600737",
             "SH.600808",
             "SH.600481",
             "SH.600879",
             "SH.601107",
             "SH.600004",
             "SH.600998",
             "SZ.000536",
             "SZ.000612",
             "SZ.000685",
             "SZ.000690",
             "SZ.000725",
             "SZ.000927",
             "SZ.000951",
             "SZ.002028",
             "SZ.002294",
             "SZ.000031",
             "SH.600018",
             "SH.600239",
             "SH.600269",
             "SH.600300",
             "SH.600312",
             "SH.600517",
             "SH.600675",
             "SH.600717",
             "SH.600823",
             "SH.600827",
             "SH.600220",
             "SH.601877",
             "SH.600325",
             "SZ.000046",
             "SZ.000652",
             "SZ.000667",
             "SZ.000900",
             "SZ.000959",
             "SZ.002242",
             "SH.600017",
             "SH.600033",
             "SH.600087",
             "SH.600210",
             "SH.600006",
             "SH.600350",
             "SH.600597",
             "SH.600601",
             "SH.600611",
             "SH.600657",
             "SH.600663",
             "SH.600748",
             "SH.601099",
             "SH.601139",
             "SH.600596",
             "SZ.000089",
             "SH.601991",
             "SH.600251",
             "SZ.000488",
             "SZ.000631",
             "SZ.000717",
             "SH.601872",
             "SZ.000932",
             "SH.600011",
             "SH.600022",
             "SH.600027",
             "SH.600102",
             "SH.600236",
             "SH.600246",
             "SZ.000897",
             "SH.600282",
             "SH.600835",
             "SH.600426",
             "SH.601801",
             "SH.601003",
             "SH.600886",
             "SH.601588",
             "SH.600820",
             "SH.600688",
             "SH.600643",
             "SH.600569",
             "SZ.000559",
             "SZ.000793",
             "SH.600874",
             "SH.600816",
             "SH.600276",
             "SH.600582",
             "SH.600648",
             "SH.600270",
             "SH.600859",
             "SH.600782",
             "SZ.002275",
             "SZ.000917",
             "SZ.000822",
             "SH.600176",
             "SH.600158",
             "SH.600639",
             "SH.600638",
             "SZ.000301",
             "SH.601005",
             "SH.600110",
             "SH.600770",
             "SZ.000543",
             "SZ.000629",
             "SZ.000725",
             "SZ.002038",
             "SZ.002194",
             "SZ.002269",
             "SZ.000912",
             "SH.600117",
             "SH.600308",
             "SH.600548",
             "SH.600616",
             "SH.600299",
             "SH.600653",
             "SH.600780",
             "SH.601003",
             "SH.600020",
             "SH.600978",
             "SZ.000088",
             "SZ.000503",
             "SZ.000755",
             "SZ.000767",
             "SZ.000829",
             "SZ.002097",
             "SZ.002146",
             "SZ.002152",
             "SH.600007",
             "SZ.000539",
             "SH.600021",
             "SH.600747",
             "SH.600062",
             "SH.600863",
             "SH.600761",
             "SH.600887",
             "SH.600591",
             "SH.600115",
             "SH.600098",
             "SH.600961",
             "SH.601002",
             "SZ.002122",
             "SZ.000029",
             "SZ.000400",
             "SZ.000550",
             "SZ.000682",
             "SZ.000708",
             "SZ.000786",
             "SZ.000970",
             "SH.600035",
             "SH.600868",
             "SH.600088",
             "SH.600161",
             "SH.600190",
             "SH.600501",
             "SH.600662",
             "SH.600754",
             "SH.600849",
             "SZ.002110"
             ]
usefulSet = set(usefulList)

def getLower(code: str):
    return code.lower()


lowerStockCodeList = list(map(getLower, stockCode))


def convertDfToCsvList(df):
    columnsName = [column for column in df]
    csvData = []
    # print("name : ", columnsName)
    for i in range(df.shape[0]):
        oneLineData = getOneLineData(df, i, columnsName)
        csvData = csvData + oneLineData
    return csvData


def getOneLineData(df, line, columns):
    oneLineData = []
    date = df["pubDate"].iloc[line]
    period = df["statDate"].iloc[line]
    symbol = df["code"].iloc[line]
    for index in columns:
        if index in usefulSet:
            value = df[index].iloc[line]
            field = index
            oneLineData.append([date, period, value, field, symbol])
    return oneLineData


def saveCodeCsv(code, data):
    file = "./csv/"+code+".csv"
    with open(file, "w") as f:
        writer = csv.writer(f)
        writer.writerow(["date", "period", "value", "field", "symbol"])
        writer.writerows(data)
